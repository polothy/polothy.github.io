<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
  <head>
    

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>Open in Emacs - Blog</title>
  <meta property="og:title" content="Open in Emacs" />
  <meta name="twitter:title" content="Open in Emacs" />
  <meta name="description" content="How to open a file/directory or pipe output to Emacs GUI from the terminal.">
  <meta property="og:description" content="How to open a file/directory or pipe output to Emacs GUI from the terminal.">
  <meta name="twitter:description" content="How to open a file/directory or pipe output to Emacs GUI from the terminal.">
  <meta name="author" content="Mark Nielsen"/><script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Blog",
    
    "url": "https:\/\/polothy.github.io\/"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "",
  "url": "https:\/\/polothy.github.io\/"
  
  
  
  
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "https:\/\/polothy.github.io\/",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "https:\/\/polothy.github.io\/post\/2018-11-13-open-in-emacs\/",
          "name": "Open in emacs"
        }
    }]
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": {
    "name" : "Mark Nielsen"
  },
  "headline": "Open in Emacs",
  "description" : "How to open a file\/directory or pipe output to Emacs GUI from the terminal.\n",
  "inLanguage" : "en",
  "wordCount":  606 ,
  "datePublished" : "2018-11-13T19:27:56",
  "dateModified" : "2018-11-13T19:27:56",
  "image" : "https:\/\/polothy.github.io\/img\/gopher-spirit-coffee.png",
  "keywords" : [ "emacs, spacemacs" ],
  "mainEntityOfPage" : "https:\/\/polothy.github.io\/post\/2018-11-13-open-in-emacs\/",
  "publisher" : {
    "@type": "Organization",
    "name" : "https:\/\/polothy.github.io\/",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "https:\/\/polothy.github.io\/img\/gopher-spirit-coffee.png",
        "height" :  60 ,
        "width" :  60
    }
  }
}
</script>

<meta property="og:title" content="Open in Emacs" />
<meta property="og:description" content="How to open a file/directory or pipe output to Emacs GUI from the terminal.">
<meta property="og:image" content="https://polothy.github.io/img/gopher-spirit-coffee.png" />
<meta property="og:url" content="https://polothy.github.io/post/2018-11-13-open-in-emacs/" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="Blog" />

  <meta name="twitter:title" content="Open in Emacs" />
  <meta name="twitter:description" content="How to open a file/directory or pipe output to Emacs GUI from the terminal.">
  <meta name="twitter:image" content="https://polothy.github.io/img/gopher-spirit-coffee.png" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@polothy" />
  <meta name="twitter:creator" content="@polothy" />
  <meta property="og:image" content="https://polothy.github.io/img/gopher-spirit-coffee.png" />
  <meta name="twitter:image" content="https://polothy.github.io/img/gopher-spirit-coffee.png" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@polothy" />
  <meta name="twitter:creator" content="@polothy" />
  <meta property="og:url" content="https://polothy.github.io/post/2018-11-13-open-in-emacs/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Blog" />

  <meta name="generator" content="Hugo 0.58.2" />
  <link rel="alternate" href="https://polothy.github.io/index.xml" type="application/rss+xml" title="Blog"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><link rel="stylesheet" href="https://polothy.github.io/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" /><link rel="stylesheet" href="https://polothy.github.io/css/syntax.css" /><link rel="stylesheet" href="https://polothy.github.io/css/codeblock.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">
<link href="https://fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet">
<link rel="stylesheet" href="https://polothy.github.io/css/site.css" />


  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://polothy.github.io/">Blog</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="Tags" href="/tags">Tags</a>
            </li>
          
        

        

        
      </ul>
    </div>

    
      <div class="avatar-container">
        <div class="avatar-img-border">
          <a title="Blog" href="https://polothy.github.io/">
            <img class="avatar-img" src="https://polothy.github.io/img/gopher-spirit-coffee.png" alt="Blog" />
          </a>
        </div>
      </div>
    

  </div>
</nav>




    


<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>


  
  
  






  

  <header class="header-section ">
    
    <div class="intro-header no-img">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="post-heading">
              
                <h1>Open in Emacs</h1>
              
              
              
              
                <span class="post-meta">
  
  
  <i class="fas fa-calendar"></i>&nbsp;Posted on November 13, 2018
  
  
    &nbsp;|&nbsp;<i class="fas fa-clock"></i>&nbsp;3&nbsp;minutes
  
  
  
    
      &nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;Mark Nielsen
    
  
  
</span>


              
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        <p>How to open a file/directory or pipe output to Emacs GUI from the terminal.</p>

<p>I like playing around with editors and my most recent discovery is Emacs with the <a href="http://spacemacs.org">Spacemacs</a> distribution.  The very first editor that I fell in love with was TextMate and one of the first things I expect every editor to have is a way to open content up from the terminal.  I like to open up files/directories and to pipe content into the editor, EG:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ mate hodor.txt
$ <span class="nb">echo</span> <span class="s2">&#34;hi&#34;</span> <span class="p">|</span> mate</code></pre></div>
<p>When I first looked at Atom, it could open files, but could not handle piping output.  VS Code could open files and eventually supported piping output, but it ended up behaving oddly.  After doing a <code>echo &quot;Hi&quot; | code -</code> it would hang in the terminal, supposedly waiting for more output to pipe.  So, you would have to close the file or <code>Ctr-c</code> to get the prompt back.  Vi(m) works well, after all, it was born in the terminal.  Thinking the same would be for Emacs, but sadly it is more complicated.</p>

<p>Before diving in, a little information about my setup.  Emacs was installed with <code>brew cask install emacs</code>.  I was using <code>emacs-plus</code> tap, but I like the simplicity of the cask.  I mention this because after switching to the cask, I had to refactor my bash script below.  In addition, you need to enable the Emacs server in your Spacemacs configuration.  Modify these settings under <code>dotspacemacs/init</code>:</p>
<div class="highlight"><pre class="chroma"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="c1">;; Start an Emacs server if one is not already running.</span>
<span class="nv">dotspacemacs-enable-server</span> <span class="ss">&#39;t</span>
<span class="c1">;; Where to save server socket file.</span>
<span class="nv">dotspacemacs-server-socket-dir</span> <span class="o">&#39;</span><span class="s">&#34;~/.emacs.d/server&#34;</span></code></pre></div>
<p>OK, continuing on.  What makes it more complicated than other editors is that you have the Emacs GUI and the Emacs server.  After lots of Googling, tinkering and more hours than I care to mention ðŸ˜„, this is what I came up with:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span>
<span class="c1"># Usage: ec file.txt</span>
<span class="c1"># OR:    echo &#34;hi&#34; | ec</span>

<span class="c1">#set -ex</span>

<span class="nv">PARAMS</span><span class="o">=(</span>-a <span class="s1">&#39;&#39;</span> -nq -s ~/.emacs.d/server/server<span class="o">)</span>

<span class="c1"># Determine if Emacs is running already or not.</span>
<span class="k">if</span> <span class="o">[</span> ! -e ~/.emacs.d/server/server <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">PARAMS</span><span class="o">+=(</span>-c<span class="o">)</span>
<span class="k">fi</span>

<span class="k">if</span> <span class="o">[</span> -z <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">TMP</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$(</span>mktemp /tmp/stdin-XXX<span class="k">)</span><span class="s2">&#34;</span>
    cat &gt;<span class="nv">$TMP</span>
    emacsclient <span class="s2">&#34;</span><span class="si">${</span><span class="nv">PARAMS</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span> <span class="nv">$TMP</span> <span class="p">&amp;</span>&gt; /dev/null
    rm <span class="nv">$TMP</span>
<span class="k">else</span>
    emacsclient <span class="s2">&#34;</span><span class="si">${</span><span class="nv">PARAMS</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> <span class="p">&amp;</span>&gt; /dev/null
<span class="k">fi</span></code></pre></div>
<p><strong>UPDATE:</strong> I modified the above script to no longer verify if the passed argument is a file or directory that exists.  Reason being, if you want to make a new file, you can with the new code, EG: <code>ec newfile.txt</code>.</p>

<p>This goes into a file named <code>ec</code> (or whatever you want) which should be in your <code>$PATH</code>.  What this does is first detects if the Emacs server is running by looking for the server socket file (we defined the location of that above). If the server is running, then Emacs is already open, so I omit the <code>-c</code> parameter to open in the current frame. Otherwise, I use <code>-c</code> to open a new frame.</p>

<p>The second thing the script does is detect if there is no argument.  If that&rsquo;s the case, then it sends the piped output to the temporary file, opens the file in Emacs GUI and then removes the file.  Otherwise, if there is an argument, open that via Emacs GUI.</p>

<p>Is it perfect? Probably not.  Detection of piping output into the script could be improved <em>a lot</em>.  I&rsquo;m betting that the detection of Emacs server running could also be improved. For example, I could imagine a scenario where the server is still running, but I have closed all the frames. But, I&rsquo;m not shooting for absolute perfection, I can now handle my to main use cases:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ ec hodor.txt
$ <span class="nb">echo</span> <span class="s2">&#34;hi&#34;</span> <span class="p">|</span> ec</code></pre></div>

        
          <div class="blog-tags">
            
              <a href="https://polothy.github.io//tags/emacs/">emacs</a>&nbsp;
            
              <a href="https://polothy.github.io//tags/spacemacs/">spacemacs</a>&nbsp;
            
          </div>
        

        

        
          
          
        
      </article>

      
        <ul class="pager blog-pager">
          
            <li class="previous">
              <a href="https://polothy.github.io/post/2018-11-07-knative-first-take/" data-toggle="tooltip" data-placement="top" title="Knative">&larr; Previous Post</a>
            </li>
          
          
            <li class="next">
              <a href="https://polothy.github.io/post/2018-12-17-reinvent-2018/" data-toggle="tooltip" data-placement="top" title="re:Invent 2018">Next Post &rarr;</a>
            </li>
          
        </ul>
      


      

    </div>
  </div>
</div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
                <a href="https://github.com/polothy" title="GitHub">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://twitter.com/polothy" title="Twitter">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://linkedin.com/in/mark-nielsen-21a982162" title="LinkedIn">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
          <li>
            <a href="" title="RSS">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
        </ul>
        <p class="credits copyright text-muted">
          
            
              <a href="https://polothy.github.io/">Mark Nielsen</a>
            
          

          &nbsp;&bull;&nbsp;&copy;
          
            2019
          

          
            &nbsp;&bull;&nbsp;
            <a href="https://polothy.github.io/">Blog</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="http://gohugo.io">Hugo v0.58.2</a> powered &nbsp;&bull;&nbsp; Theme by <a href="http://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a> adapted to <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a>
          
        </p>
      </div>
    </div>
  </div>
</footer><script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.js" integrity="sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/contrib/auto-render.min.js" integrity="sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<script src="https://polothy.github.io/js/main.js"></script><script> renderMathInElement(document.body); </script><script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script><script src="https://polothy.github.io/js/load-photoswipe.js"></script>









  </body>
</html>

